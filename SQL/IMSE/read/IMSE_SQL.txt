
CREATE DATABASE IF NOT EXISTS InsurnaceCompany;

USE InsurnaceCompany;

CREATE TABLE IF NOT EXISTS Company(
UidNumber INT NOT NULL AUTO_INCREMENT,
CompanyName VARCHAR(40) NOT NULL,
City VARCHAR(25),
Street VARCHAR(25),
PRIMARY KEY(UidNumber)
)ENGINE=INNODB;


CREATE TABLE IF NOT EXISTS Employee(
EmployeeId INT NOT NULL AUTO_INCREMENT,
TelephoneNumber VARCHAR(20) NOT NULL,
EmployeeName VARCHAR(25) NOT NULL,
EmployeeSurname VARCHAR(35) NOT NULL,
BaseSalary INT NOT NULL,
SupervisorId INT ,
CompanyUIDNumber INT NOT NULL,
PRIMARY KEY(EmployeeId),
FOREIGN KEY(SupervisorId) REFERENCES Employee(EmployeeId),
FOREIGN KEY(CompanyUIDNumber) REFERENCES Company(UidNumber)
)ENGINE=INNODB;


CREATE TABLE IF NOT EXISTS Customer(
CustomerId INT NOT NULL AUTO_INCREMENT,
CustomerName VARCHAR(25) NOT NULL,
CustomerSurname VARCHAR(35) NOT NULL,
CustomerSince DATE NOT NULL,
EmployeeId INT NOT NULL, 
PRIMARY KEY(CustomerId),
FOREIGN KEY(EmployeeId) REFERENCES Employee(EmployeeId)
)ENGINE=INNODB;

CREATE TABLE IF NOT EXISTS Spouse(
CustomerID INT NOT NULL,
SpouseName VARCHAR(25) NOT NULL,
HaveChildren TINYINT NOT NULL,
SpouseSince DATE NOT NULL,
PRIMARY KEY(CustomerId, SpouseName),
FOREIGN KEY(CustomerId) REFERENCES Customer(CustomerId)
)ENGINE=INNODB;


CREATE TABLE IF NOT EXISTS Schooling(
SchoolingId INT NOT NULL AUTO_INCREMENT,
SchoolingName VARCHAR(30) NOT NULL,
Termin DATE NOT NULL,
CompanyUIDNUmber INT NOT NULL,
PRIMARY KEY(SchoolingId),
FOREIGN KEY(CompanyUIDNumber) REFERENCES Company(UidNumber)
)ENGINE=INNODB;

CREATE TABLE IF NOT EXISTS TakePart(
SchoolingId INT NOT NULL,
CustomerId INT NOT NULL,
PRIMARY KEY(SchoolingId, CustomerId),
FOREIGN KEY(SchoolingId) REFERENCES Schooling(SchoolingId),
FOREIGN KEY(CustomerId) REFERENCES Customer(CustomerId)
)ENGINE=INNODB;

CREATE TABLE IF NOT EXISTS Insurance(
InsuranceId INT NOT NULL AUTO_INCREMENT,
ValidFrom DATE NOT NULL,
ValidUntil DATE NOT NULL,
PRIMARY KEY(insuranceId)
)ENGINE=INNODB;

CREATE TABLE IF NOT EXISTS Transactionn(
CustomerId INT NOT NULL,
EmployeeId INT NOT NULL,
InsuranceId INT NOT NULL,
Termin DATE NOT NULL,
PRIMARY KEY(CustomerId, EmployeeId, InsuranceId),
FOREIGN KEY(CustomerId) REFERENCES Customer(CustomerId),
FOREIGN KEY(EmployeeId) REFERENCES Employee(EmployeeId),
FOREIGN KEY(InsuranceId) REFERENCES Insurance(InsuranceID)
)ENGINE=INNODB;


CREATE TABLE IF NOT EXISTS AutoInsurance(
InsuranceId INT NOT NULL AUTO_INCREMENT,
CarBrand VARCHAR(20) NOT NULL,
ProductionYear VARCHAR(20) NOT NULL,
PRIMARY KEY(insuranceId)
)ENGINE=INNODB;

CREATE TABLE IF NOT EXISTS HealthInsurance(
InsuranceId INT NOT NULL AUTO_INCREMENT,
isInternationalValid TINYINT,
ValidWithHealthProblems TINYINT,
PRIMARY KEY(insuranceId)
)ENGINE=INNODB;
